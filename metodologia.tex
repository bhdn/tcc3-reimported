%
% Metodologia
%
%
% - diagramas de contexto descrevendo quais serão as informações de
%   entrada, qual módulo do software fará o processamento e como serão
%   disponibilizadas as informações da predição,
% - diagrama de classes para a implementação do software,
% 
% - descrição de quais técnicas serão utilizadas e como serão implementadas,
% - descrição de um protocolo para avaliação do desempenho das técnicas
% implementadas.
%
%

\chapter{Metodologia de desenvolvimento}\label{sec:meto}

\section{Introdução}

% Em um ambiente de virtualização gerenciado pela ferramenta \libvirt{}
% (apresentada na seção \ref{sec:libvirt}), o software executará em plano de
% fundo (ou seja, será um \emph{daemon}) e estará periodicamente coletando
% informações quantitativas a respeito do tempo de uso de processador de
% cada uma das máquinas virtuais que fazem parte de um determinado
% \emph{domínio}. Este utilizará tais informações para treinar um
% mecanismo de aprendizado de máquina. Utilizando este mecanismo, a
% ferramenta poderá então prever em quais situações alguma máquina virtual
% exigirá mais uso de processador que a máquina \emph{host} em que ela
% executa terá condições de atender sem prejudicar as outras.

A figura \ref{fig:hostguests1} apresenta um ambiente de virtualização
mínimo, aonde tem-se um computador, denominado \texttt{host}, que está
hospedando três máquinas virtuais \texttt{mv-1}, \texttt{mv-2} e
\texttt{mv-3}. Estas máquinas virtuais estão sendo gerenciadas por qualquer
uma das ferramentas que são suportadas pela \libvirt{}, e cada uma delas
pode estar executando qualquer sistema operacional, e nestes podem estar
executando qualquer tipo de software, mais comumente servidores de banco de
dados e aplicações Web.

\begin{figure}[htp]
\centering
\includegraphics{img-host-guests1.pdf}
\figinfo{Um \emph{host} e várias máquinas virtuais (\emph{guests})}{autoria própria}
\label{fig:hostguests1}
\end{figure}

Se o indivíduo que criou este ambiente esperava que as aplicações que
executam dentro das máquinas virtuais tenham um \emph{bom desempenho},
então ele deve ter estudado os usos de processador, memória e entrada/saída
dessas aplicações e dimensionado o ambiente de tal maneira que uma máquina
virtual não degrade o desempenho de outra a ponto de torná-lo inaceitável.

\begin{figure}[htp]
\centering
\includegraphics{img-host-guests2.pdf}
\figinfo{Um \emph{host} e várias máquinas virtuais (\emph{guests})}{autoria própria}
\label{fig:hostguests2}
\end{figure}

Porém, à medida que mais máquinas virtuais forem necessárias, como é
apresentado na figura \ref{fig:hostguests2}, novas máquinas físicas terão
que ser alocadas para acomodar as novas demandas. E a partir deste ponto
gerenciar este parque computacional começa a tornar-se uma tarefa
desafiadora, pois é necessário tentar acomodar tais máquinas virtuais
levando em conta as necessidades particulares de cada aplicação que estão
executando nelas.

\begin{figure}[htp]
\centering
\includegraphics{img-host-guests3.pdf}
\figinfo{Dois hóspedeiros e carga das MVs desbalanceada entre eles}{autoria própria}
\label{fig:hostguests3}
\end{figure}

Na figura \ref{fig:hostguests3}, a máquina \texttt{host3} possui cinco máquinas
virtuais que ocupam, ao todo, 57\% do tempo de processamento. Se estas
máquinas virtuais mantiverem o mesmo comportamento no decorrer do tempo de
vida deste ambiente, a única mudança necessária seria de talvez desligar
\texttt{host1} e migrar estas máquinas virtuais para \texttt{host3}, já que
este hospedeiro ainda tem aproximadamente 43\% de tempo de processamento
sendo desperdiçado. Sendo \texttt{host1} desligada, haveriam menos custos
com energia e manutenção.

Porém, os serviços que executam nestas máquinas virtuais podem sofrer um
abrupto aumento de demanda, o que é mais ainda provável em aplicações que
estão acessíveis por meio da Internet, como servidores web, ou serviços
relacionados, como servidores de banco de dados. Nestes casos, o
adminstrador do ambiente precisa provisionar rapidamente recursos para
atender a essa demanda.

\begin{figure}[htp]
\centering
\includegraphics{img-host-guests4.pdf}
\figinfo{Dois hóspedeiros e carga das MVs desbalanceada entre eles}{autoria própria}
\label{fig:hostguests4}
\end{figure}

No exemplo da figura \ref{fig:hostguests4}, a máquina virtual
\texttt{vm-11} está executando algum processo que está exigindo muito tempo
de CPU. % FIXME


% colocar aqui um ou mais diagramas descrevendo as máquinas virtuais que
% estão em um ambiente "folgado" e então indicar uma situação em que uma
% máquina virtual precisa ser migrada e daí migrar para outra máquina.

\section{Modelagem do software}

A figura \ref{fig:contexto0} apresenta um diagrama de contexto, de nível 0,
indicando a relação entre o projeto que será desenvolvido e a biblioteca
\libvirt{}. O fluxo \texttt{estatísticas das máq. virtuais} indica as
informações a respeito de uso de CPU que são providas pela libVirt,
enquanto que \texttt{cmds. de migração} indica os comandos, transmitidos
por meio da API (introduzida na seção \ref{sec:libvirtapi}), que são enviadas
à \libvirt{} para a migração das máquinas virtuais, de acordo com o que o
software a ser implementado decidir.

\begin{figure}
\centering
\includegraphics{img-met-contexto-0.pdf}
\figinfo{Diagrama de contexto, interação entre as principais entidades no
sistema}{autoria própria}
\label{fig:contexto0}
\end{figure}

% diagrama de classes

\section{Implementação}


\section{Treinamento}

\section{Avaliação de desempenho}\label{sec:desemp}

% utilizar SVM, K-NN, AR(16) (se for fácil de implementar)
% variar o tamanho das janelas de histórico
% utilizar uma instância do classificador para todas as VMs, versus
% utilizar uma instância nova para cada VM
